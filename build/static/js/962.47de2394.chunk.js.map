{"version":3,"file":"static/js/962.47de2394.chunk.js","mappings":"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","sources":["validation/singin.js","components/AuthForms/SignIn.js","pages/auth/SignIn.js","utils/axios.js","webpack://client/./src/pages/auth/Auth.module.scss?a5aa"],"sourcesContent":["import * as yup from \"yup\"\r\n\r\nexport default yup.object().shape({\r\n    email: yup.string().email().required(\"Email is invalid\").max(20),\r\n    password: yup.string().required(\"Password have to be from 6 to 16 characters\").min(4).max(16),\r\n})","import React, { useState, useContext, useEffect } from \"react\";\r\nimport { Context } from \"../../index\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport axios from '../../utils/axios';\r\nimport { observer } from \"mobx-react-lite\";\r\nimport { SIGN_UP } from \"../../routes/const\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Button, Input, Heading, FormControl, Box, FormErrorMessage } from \"@chakra-ui/react\";\r\nimport jwtDecode from \"jwt-decode\";\r\nimport signInSchema from \"../../validation/singin\";\r\nimport { useForm } from 'react-hook-form';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\n\r\nconst SignInForm = observer(() => {\r\n    const { user } = useContext(Context);\r\n    const navigator = useNavigate();\r\n    // const [email, setEmail] = useState('');\r\n    // const [password, setPassword] = useState('');\r\n\r\n    const { register, handleSubmit, formState: { errors } } = useForm({\r\n        resolver: yupResolver(signInSchema),\r\n    });\r\n\r\n\r\n    useEffect(() => {\r\n        const token = localStorage.getItem(\"Token\");\r\n        console.log(token);\r\n        if (token) {\r\n            navigator('/')\r\n        }\r\n    }, []);\r\n\r\n    const submit = async (values) => {\r\n        if (values) {\r\n            const response = await axios.post('user/login', { email: values.email, password: values.password });\r\n            if (response.status === 200) {\r\n                var decode = jwtDecode(response.data.token)\r\n                user.setUser({\r\n                    id: decode.id,\r\n                    name: decode.name,\r\n                    email: decode.email,\r\n                    role: decode.role\r\n                })\r\n                if (user.user.role === \"admin\") {\r\n                    user.setIsAdmin(true)\r\n                }\r\n                user.setIsAuth(true)\r\n                localStorage.setItem(\"Token\", \"Bearer \" + response.data.token);\r\n                navigator('/');\r\n            };\r\n        }\r\n        window.location.reload()\r\n    }\r\n\r\n    return (\r\n        <Box w='500px' bg='gray.100' rounded={10} p=\"20px\" display='flex' flexDirection=\"column\" alignItems=\"center\">\r\n            <Heading my=\"20px\">Увійти</Heading>\r\n            <FormControl\r\n                my=\"10px\"\r\n                px=\"40px\"\r\n                isInvalid={!!errors?.email?.message}\r\n                errortext={errors?.email?.message}\r\n            >\r\n                <Input bg='gray.100' type='email' placeholder=\"Email\"  {...register(\"email\")} />\r\n                <FormErrorMessage>{errors?.email?.message}</FormErrorMessage>\r\n            </FormControl>\r\n            <FormControl\r\n                my=\"10px\"\r\n                px=\"40px\"\r\n                isInvalid={!!errors?.password?.message}\r\n                errortext={errors?.password?.message}\r\n            >\r\n                <Input bg='gray.100' type='password' placeholder=\"Пароль\" {...register(\"password\")} />\r\n                <FormErrorMessage>{errors?.password?.message}</FormErrorMessage>\r\n            </FormControl>\r\n            <Button w=\"80%\" my=\"10px\" colorScheme=\"teal\" onClick={handleSubmit(submit)}>Увійти</Button>\r\n            <Link to={SIGN_UP}>Реєстрація</Link>\r\n        </Box>\r\n    );\r\n})\r\n\r\nexport default SignInForm;\r\n","import React from \"react\";\r\nimport SignInForm from \"../../components/AuthForms/SignIn\";\r\nimport { observer } from \"mobx-react-lite\";\r\nimport styles from \"./Auth.module.scss\";\r\n\r\nconst SignUp = observer(() => {\r\n    return <div id={styles.wrapper}>\r\n        <SignInForm />\r\n    </div>;\r\n});\r\n\r\nexport default SignUp;\r\n","import axios from \"axios\";\r\n\r\nconst instance = axios.create({\r\n  baseURL: \"https://mydiplomlevas.herokuapp.com/api/\",\r\n  headers: {\r\n    'Authorization': localStorage.getItem(\"Token\") ?? \"\"\r\n  }\r\n});\r\n\r\ninstance.interceptors.response.use(\r\n  res => res,\r\n  error => {\r\n    if (error.response.status === 401) {\r\n      localStorage.removeItem(\"Token\");\r\n    };\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default instance;","// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"Auth_wrapper__Od48h\"};"],"names":["yup","shape","email","required","max","password","min","SignInForm","observer","user","useContext","Context","navigator","useNavigate","useForm","resolver","yupResolver","signInSchema","register","handleSubmit","errors","formState","useEffect","token","localStorage","getItem","console","log","submit","values","axios","response","status","decode","jwtDecode","data","setUser","id","name","role","setIsAdmin","setIsAuth","setItem","window","location","reload","w","bg","rounded","p","display","flexDirection","alignItems","my","px","isInvalid","message","errortext","type","placeholder","colorScheme","onClick","to","SIGN_UP","styles","SignIn","instance","baseURL","headers","interceptors","use","res","error","removeItem","Promise","reject"],"sourceRoot":""}